TODO: fix x_vector caching to be efficient
TODO: benchmark all matricies
