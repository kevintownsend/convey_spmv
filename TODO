TODO: create reset that can recover from errors.
